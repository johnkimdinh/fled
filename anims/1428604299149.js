{"name":"Mandlebrot zoomer","filename":"1428604299149.js","author":"Ben","code":"function Mandeliter( cx, cy, maxiter ){\r\n  var\r\n    x = 0.0,\r\n    y = 0.0,\r\n    xx = 0,\r\n    yy = 0,\r\n    xy = 0;\r\n \r\n  var i = maxiter;\r\n  while( i-- && xx + yy <= 4 ){\r\n    xy = x * y;\r\n    xx = x * x;\r\n    yy = y * y;\r\n    x = xx - yy + cx;\r\n    y = xy + xy + cy;\r\n  }\r\n  return maxiter - i;\r\n}\r\n \r\nfunction Mandelbrot( display, xmin,xmax, ymin,ymax, iterations ){\r\n  var width = display.cols, height = display.rows;\r\n  \r\n  for( var ix = 0; ix < width; ++ix )\r\n    for( var iy = 0; iy < height; ++iy )\r\n    {\r\n      var x = xmin + (xmax - xmin) * ix / (width - 1);\r\n      var y = ymin + (ymax - ymin) * iy / (height - 1);\r\n      var i = Mandeliter( x, y, iterations );\r\n      var ppos = (width * iy + ix);\r\n      if( i === iterations )\r\n      {\r\n        display.leds[ppos] = new Color(0);\r\n      }\r\n      else\r\n      {\r\n        var c =  Math.log(i)/Math.log(iterations - 1.0);\r\n        // c is in range 0 to 1\r\n        // want mostly red, with brighter reds as c increases\r\n        var col = new Color();\r\n        col.setRGB(c, 0,0);\r\n        display.leds[ppos] = col;\r\n        /*var c = 0 + Math.log(Math.log(Math.abs(i)))/Math.log(2);\r\n        var col = new Color();\r\n        col.setHSL(0.75 + (0.95 + c)%1, 1, 0.5);\r\n        display.leds[ppos] = col;*/\r\n       /* if (c < 1)\r\n        {\r\n            var col = new Color();\r\n            col.setRGB(c, 0,0);\r\n            display.leds[ppos] = col;\r\n        }\r\n        else if( c < 2 )\r\n        {\r\n            var col = new Color();\r\n            col.setRGB(1, (c-1), 0);\r\n            display.leds[ppos] = col;\r\n        }\r\n        else\r\n        {\r\n            var col = new Color();\r\n            col.setRGB(0.5, 1*(c-2), c-2);\r\n            display.leds[ppos] = col;\r\n        }*/\r\n      }\r\n      //pix[ ppos+3 ] = 255;\r\n    }\r\n}\r\n // example code, renders a basic rainbow\r\nvar tweenedValues = {\r\n\thue: 0,\r\n\t/*xmin: -2, //xmin: -2,\r\n\txmax: 1, //xmax: 1\r\n\tymin: -1,\r\n\tymax: 1,*/\r\n\txmin:-1.6194893102830346,\r\n\tymin:-0.7911970621472677,\r\n\txmax:0.07785467761613862,\r\n\tymax:0.07757265394106039\r\n};\r\n\r\nreturn {\r\n\tinit: function(display,timeline) {\r\n\t\tthis.display = display;\r\n\t//\tdebugger;\r\n      \tdisplay.tween(tweenedValues,{\r\n            to: {\r\n                xmin:-0.7824672913071709,\r\n                ymin:-0.1257914356288737,\r\n                xmax:-0.7777378287713843,\r\n                ymax:-0.12337070426636942\r\n                //xmin:-0.75, xmax: -0.75,\r\n                //ymin: 0.1, ymax: 0.1\r\n                //xmin: 0.274, xmax: 0.274,\r\n                //ymin: 0.482, ymax: 0.482\r\n            },\r\n            duration: 10000,\r\n            repeat: Infinity,\r\n            yoyo: true,\r\n            delay: 0,\r\n            easing: TWEEN.Easing.Cubic.In\r\n        });\r\n        \r\n\t},\r\n\tonUpdate: function(display, data) {\r\n        Mandelbrot( display, tweenedValues.xmin,tweenedValues.xmax, tweenedValues.ymin,tweenedValues.ymax, 1000 );\r\n\t}\r\n};","publish":true,"script":{}}